---
title: "iSCSI μ‹¤μµ κΈ°λ° μ •λ¦¬"
excerpt: "iSCSI κµ¬μ„±, μλ™ λ§μ΄νΈ, ν…μ¤νΈ λ° μ μ©μ„±μ— κ΄€ν•΄ μ•μ•„λ΄…λ‹λ‹¤"
categories:
  - Storage
toc: true
toc_sticky: true
last_modified_at: 2025-04-17
---

iSCSIλ” TCP/IP λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄ μ¤ν† λ¦¬μ§€λ¥Ό κ³µμ ν•  μ μλ” λΈ”λ΅ μ¤ν† λ¦¬μ§€ ν”„λ΅ν† μ½μ…λ‹λ‹¤. 
Fibre Channelλ³΄λ‹¤ μ €λ ΄ν•κ³ , μΌλ° μ΄λ”λ„· ν™κ²½μ—μ„ μ‰½κ² κµ¬μ„±ν•  μ μμ–΄ VM, κ³ κ°€μ©μ„± ν΄λ¬μ¤ν„°, μ¤ν† λ¦¬μ§€ μ„λ²„ κµ¬μ¶• λ“±μ—μ„ λ§μ΄ ν™μ©λ©λ‹λ‹¤. 

λ³Έ ν¬μ¤ν…μ—μ„λ” λ‘ λ€μ μ„λ²„λ¥Ό ν™μ©ν•΄ iSCSI Target/Initiatorλ¥Ό κµ¬μ„±ν•λ” λ°©λ²•κ³Ό μλ™ λ§μ΄νΈ λ°©λ²•μ„ ν•¨κ» μ •λ¦¬ν•©λ‹λ‹¤.

## μ„λ²„ κµ¬μ„± κ°μ”

|μ—­ν•  | Hostname | IP μ£Όμ† | μ„¤λ…|
|:----  |:----  |:-|:----|
|iSCSI νƒ€κ² μ„λ²„ | target-server | 192.168.56.12 | μ¤ν† λ¦¬μ§€ μ κ³µ|
|μ΄λ‹μ‹μ—μ΄ν„° μ„λ²„ | initiator-client | 192.168.56.11 | μ¤ν† λ¦¬μ§€ μ—°κ²° (ν΄λΌμ΄μ–ΈνΈ)|

---

## 1. Target μ„λ²„ μ„¤μ • (192.168.56.12)

### π”Έ [1] λ””μ¤ν¬ νμΌ μ¤€λΉ„

```bash
mkdir -p /var/iscsi_disks
truncate -s 5G /var/iscsi_disks/disk1.img
```

### π”Έ [2] targetcli κµ¬μ„±
```bash
targetcli
/> backstores/fileio create disk1 /var/iscsi_disks/disk1.img 5G
/> iscsi/ create iqn.2025-04.cccr.example:storage1
/> cd iscsi/iqn.2025-04.cccr.example:storage1/tpg1
/> luns create /backstores/fileio/disk1
/> portals create 192.168.56.12 3260
/> acls create iqn.2025-04.cccr.example:client1
/> saveconfig
```
| β— ν¬ν„Έμ€ νƒ€κ² μ„λ²„μ μ‹¤μ  IPλ΅ μ§€μ •ν•΄μ•Ό ν•λ©°, ACLμ—λ” ν΄λΌμ΄μ–ΈνΈ IQNμ„ λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤.

---

## 2. Initiator ν΄λΌμ΄μ–ΈνΈ μ„¤μ • (192.168.56.11)

### π”Έ [1] InitiatorName μ„¤μ •

```bash
echo "InitiatorName=iqn.2025-04.cccr.example:client1" > /etc/iscsi/initiatorname.iscsi
systemctl restart iscsid
```

### π”Έ [2] discovery λ° λ΅κ·ΈμΈ

```bash
iscsiadm -m discovery -t sendtargets -p 192.168.56.12
iscsiadm -m node --login
```

### π”Έ [3] λ””λ°”μ΄μ¤ ν™•μΈ

```bash
lsblk
# /dev/sdb λ“±μΌλ΅ μƒ λ””μ¤ν¬κ°€ λ³΄μ„

client $ lsblk
NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda                  8:0    0  128G  0 disk 
β”β”€sda1               8:1    0    1G  0 part /boot
β””β”€sda2               8:2    0  127G  0 part 
  β”β”€rl_rocky9-root 253:0    0   70G  0 lvm  /
  β””β”€rl_rocky9-swap 253:1    0    2G  0 lvm  [SWAP]
**sdb                  8:16   0   10G  0 disk** 
```

## 3. μλ™ λ§μ΄νΈ κµ¬μ„±

### π”Έ [1] νν‹°μ… λ° ν¬λ§·

```bash
fdisk /dev/sdb     # n β†’ w
mkfs.xfs /dev/sdb1
```

### π”Έ [2] λ§μ΄νΈ λ° fstab μ„¤μ •

```bash
mkdir -p /mnt/iscsi
mount /dev/sdb1 /mnt/iscsi

echo '/dev/sdb1 /mnt/iscsi xfs defaults,_netdev 0 0' >> /etc/fstab
```
> _netdev μµμ…μ€ λ„¤νΈμ›ν¬ μ—°κ²° μ΄ν›„ λ§μ΄νΈλ¥Ό λ³΄μ¥


